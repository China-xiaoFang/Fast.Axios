import{AxiosHeaders as e,AxiosError as s}from"axios";import o from"../../node_modules/.pnpm/axios@1.13.2/node_modules/axios/lib/core/settle.mjs";import{resolveUniAppRequestOptions as t}from"../utils/index.mjs";import r from"./onCanceled.mjs";const n=n=>new Promise((i,a)=>{const u=t(n),d=n;d.headers=new e(u.header);const c=new r(n);let l=uni.request({...u,success(s){if(!l)return;const t=new e(s.header),r={config:d,data:s.data,headers:t,status:s.statusCode,statusText:s.errMsg??"OK",request:l,cookies:s.cookies};o(i,a,r),l=null},fail(e){const{errMsg:o=""}=e??{};if(o){const e="request:fail abort"===o,t="request:fail ssl"===o,r="request:fail"===o||"request:fail "===o;"request:fail timeout"===o&&a(new s(o,s.ETIMEDOUT,d,l)),e&&a(new s(o,s.ECONNABORTED,d,l)),t&&a(new s(o,s.ERR_NETWORK,d,l)),r&&a(new s(o,s.ERR_NETWORK,d,l))}a(new s(e.errMsg,void 0,d,l)),l=null},complete(){c.unsubscribe()}});"function"==typeof n.onHeadersReceived&&l.onHeadersReceived(n.onHeadersReceived),c.subscribe(l,a)});export{n as default};
//# sourceMappingURL=request.mjs.map
