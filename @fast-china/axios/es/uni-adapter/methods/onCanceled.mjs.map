{"version":3,"file":"onCanceled.mjs","sources":["../../../../../src/uni-adapter/methods/onCanceled.ts"],"sourcesContent":["import { CanceledError } from \"axios\";\nimport type { AxiosRequestConfig, InternalAxiosRequestConfig } from \"axios\";\n\nexport default class OnCanceled<T> {\n\tconfig: AxiosRequestConfig<T>;\n\tprivate onCanceled?: (cancel?: any) => void;\n\tconstructor(config: AxiosRequestConfig<T>) {\n\t\tthis.config = config;\n\t}\n\n\tsubscribe(task: any, reject: any): void {\n\t\tif (this.config.cancelToken || this.config.signal) {\n\t\t\tthis.onCanceled = (cancel?: any): void => {\n\t\t\t\tif (!task) return;\n\n\t\t\t\treject(!cancel || cancel.type ? new CanceledError(undefined, undefined, this.config as InternalAxiosRequestConfig, task) : cancel);\n\t\t\t\ttask.abort();\n\t\t\t\ttask = null;\n\t\t\t};\n\t\t\tif (this.config.cancelToken) {\n\t\t\t\t// @ts-expect-error ignore\n\t\t\t\tthis.config.cancelToken.subscribe(this.onCanceled);\n\t\t\t}\n\n\t\t\tif (this.config.signal && this.config.signal.addEventListener) {\n\t\t\t\tthis.config.signal.aborted ? this.onCanceled() : this.config.signal.addEventListener(\"abort\", this.onCanceled);\n\t\t\t}\n\t\t}\n\t}\n\n\tunsubscribe(): void {\n\t\tif (this.config.cancelToken) {\n\t\t\t// @ts-expect-error ignore\n\t\t\tthis.config.cancelToken.unsubscribe(this.onCanceled);\n\t\t}\n\n\t\tif (this.config.signal && this.config.signal.removeEventListener) this.config.signal.removeEventListener(\"abort\", this.onCanceled);\n\t}\n}\n"],"names":["OnCanceled","config","onCanceled","constructor","this","subscribe","task","reject","cancelToken","signal","cancel","type","CanceledError","abort","addEventListener","aborted","unsubscribe","removeEventListener"],"mappings":"sCAGA,MAAqBA,EACpBC,OACQC,WACR,WAAAC,CAAYF,GACXG,KAAKH,OAASA,CACf,CAEA,SAAAI,CAAUC,EAAWC,IAChBH,KAAKH,OAAOO,aAAeJ,KAAKH,OAAOQ,UAC1CL,KAAKF,WAAcQ,IACbJ,IAELC,GAAQG,GAAUA,EAAOC,KAAO,IAAIC,OAAc,OAAW,EAAWR,KAAKH,OAAsCK,GAAQI,GAC3HJ,EAAKO,QACLP,EAAO,OAEJF,KAAKH,OAAOO,aAEfJ,KAAKH,OAAOO,YAAYH,UAAUD,KAAKF,YAGpCE,KAAKH,OAAOQ,QAAUL,KAAKH,OAAOQ,OAAOK,mBAC5CV,KAAKH,OAAOQ,OAAOM,QAAUX,KAAKF,aAAeE,KAAKH,OAAOQ,OAAOK,iBAAiB,QAASV,KAAKF,aAGtG,CAEA,WAAAc,GACKZ,KAAKH,OAAOO,aAEfJ,KAAKH,OAAOO,YAAYQ,YAAYZ,KAAKF,YAGtCE,KAAKH,OAAOQ,QAAUL,KAAKH,OAAOQ,OAAOQ,qBAAqBb,KAAKH,OAAOQ,OAAOQ,oBAAoB,QAASb,KAAKF,WACxH"}