{"version":3,"file":"onCanceled.js","sources":["../../../../../src/uni-adapter/methods/onCanceled.ts"],"sourcesContent":["import { CanceledError } from \"axios\";\nimport type { AxiosRequestConfig, InternalAxiosRequestConfig } from \"axios\";\n\nexport default class OnCanceled<T> {\n\tconfig: AxiosRequestConfig<T>;\n\tprivate onCanceled?: (cancel?: any) => void;\n\tconstructor(config: AxiosRequestConfig<T>) {\n\t\tthis.config = config;\n\t}\n\n\tsubscribe(task: any, reject: any): void {\n\t\tif (this.config.cancelToken || this.config.signal) {\n\t\t\tthis.onCanceled = (cancel?: any): void => {\n\t\t\t\tif (!task) return;\n\n\t\t\t\treject(!cancel || cancel.type ? new CanceledError(undefined, undefined, this.config as InternalAxiosRequestConfig, task) : cancel);\n\t\t\t\ttask.abort();\n\t\t\t\ttask = null;\n\t\t\t};\n\t\t\tif (this.config.cancelToken) {\n\t\t\t\t// @ts-expect-error ignore\n\t\t\t\tthis.config.cancelToken.subscribe(this.onCanceled);\n\t\t\t}\n\n\t\t\tif (this.config.signal && this.config.signal.addEventListener) {\n\t\t\t\tthis.config.signal.aborted ? this.onCanceled() : this.config.signal.addEventListener(\"abort\", this.onCanceled);\n\t\t\t}\n\t\t}\n\t}\n\n\tunsubscribe(): void {\n\t\tif (this.config.cancelToken) {\n\t\t\t// @ts-expect-error ignore\n\t\t\tthis.config.cancelToken.unsubscribe(this.onCanceled);\n\t\t}\n\n\t\tif (this.config.signal && this.config.signal.removeEventListener) this.config.signal.removeEventListener(\"abort\", this.onCanceled);\n\t}\n}\n"],"names":["constructor","config","__publicField","this","subscribe","task","reject","cancelToken","signal","onCanceled","cancel","type","CanceledError","abort","addEventListener","aborted","unsubscribe","removeEventListener"],"mappings":"+SAGA,MAGC,WAAAA,CAAYC,GAFZC,EAAAC,KAAA,UACQD,EAAAC,KAAA,cAEPA,KAAKF,OAASA,CAAA,CAGf,SAAAG,CAAUC,EAAWC,IAChBH,KAAKF,OAAOM,aAAeJ,KAAKF,OAAOO,UACrCL,KAAAM,WAAcC,IACbL,IAELC,GAAQI,GAAUA,EAAOC,KAAO,IAAIC,EAAAA,mBAAc,OAAW,EAAWT,KAAKF,OAAsCI,GAAQK,GAC3HL,EAAKQ,QACER,EAAA,KAAA,EAEJF,KAAKF,OAAOM,aAEfJ,KAAKF,OAAOM,YAAYH,UAAUD,KAAKM,YAGpCN,KAAKF,OAAOO,QAAUL,KAAKF,OAAOO,OAAOM,mBAC5CX,KAAKF,OAAOO,OAAOO,QAAUZ,KAAKM,aAAeN,KAAKF,OAAOO,OAAOM,iBAAiB,QAASX,KAAKM,aAErG,CAGD,WAAAO,GACKb,KAAKF,OAAOM,aAEfJ,KAAKF,OAAOM,YAAYS,YAAYb,KAAKM,YAGtCN,KAAKF,OAAOO,QAAUL,KAAKF,OAAOO,OAAOS,qBAAqBd,KAAKF,OAAOO,OAAOS,oBAAoB,QAASd,KAAKM,WAAU"}