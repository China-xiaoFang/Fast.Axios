{"version":3,"file":"fastAxios.js","sources":["../../../../src/axios/fastAxios.ts"],"sourcesContent":["import { merge } from \"lodash-unified\";\nimport type { AxiosOptions, FastAxiosOption } from \"./type\";\n\nconst defaultState: FastAxiosOption = {\n\ttimeout: 60000,\n\trequestCipher: true,\n\tloading: {\n\t\t// eslint-disable-next-line @typescript-eslint/no-empty-function\n\t\tshow: (text: string): void => {},\n\t\t// eslint-disable-next-line @typescript-eslint/no-empty-function\n\t\tclose: (options: AxiosOptions): void => {},\n\t},\n\tmessage: {\n\t\tsuccess: (message) => {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.log(`[Fast.Axios] ${message}`);\n\t\t},\n\t\twarning: (message) => {\n\t\t\tconsole.warn(`[Fast.Axios] ${message}`);\n\t\t},\n\t\tinfo: (message) => {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.log(`[Fast.Axios] ${message}`);\n\t\t},\n\t\terror: (message) => {\n\t\t\tconsole.error(`[Fast.Axios] ${message}`);\n\t\t},\n\t},\n\tmessageBox: {\n\t\tconfirm: (options) => {\n\t\t\tif (typeof uni !== \"undefined\") {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\ttitle: \"温馨提示\",\n\t\t\t\t\t\tcontent: options.message,\n\t\t\t\t\t\tcancelText: options.cancelButtonText,\n\t\t\t\t\t\tconfirmText: options.confirmButtonText,\n\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treject();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfail: (res) => {\n\t\t\t\t\t\t\tres && console.error(res);\n\t\t\t\t\t\t\tthrow new Error(\"'uni.showModal' Api调用异常。\");\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tif (typeof window.confirm === \"undefined\") {\n\t\t\t\t\t\tthrow new Error(\"'window.confirm' Api调用异常。\");\n\t\t\t\t\t}\n\t\t\t\t\t// eslint-disable-next-line no-alert\n\t\t\t\t\tif (window.confirm(options.message)) {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t},\n};\n\nclass FastAxios {\n\t// eslint-disable-next-line no-use-before-define\n\tprivate static instance: FastAxios;\n\tprivate state: FastAxiosOption;\n\n\tpublic constructor(options?: FastAxiosOption) {\n\t\tthis.state = merge(defaultState, options || {});\n\t}\n\n\t/** 获取实例 */\n\tpublic static getInstance(): FastAxios {\n\t\tif (!FastAxios.instance) {\n\t\t\treturn new FastAxios();\n\t\t\t// throw new Error(\"请先调用 'createFastAxios' 初始化 'fast-axios'。\");\n\t\t}\n\n\t\treturn FastAxios.instance;\n\t}\n\n\t/**\n\t * 设置选项\n\t * @param key\n\t * @param value\n\t */\n\tsetOptions<K extends keyof FastAxiosOption>(key: K, value: FastAxiosOption[K]): void {\n\t\tthis.state[key] = merge(this.state[key], value);\n\t}\n\n\t/** 请求域名或者Base路径 */\n\tget baseUrl(): FastAxiosOption[\"baseUrl\"] {\n\t\treturn this.state.baseUrl;\n\t}\n\n\t/** 请求域名或者Base路径 */\n\tset baseUrl(value: FastAxiosOption[\"baseUrl\"]) {\n\t\tthis.setOptions(\"baseUrl\", value);\n\t}\n\n\t/**\n\t * 超时时间，单位毫秒\n\t * @default 60000\n\t */\n\tget timeout(): FastAxiosOption[\"timeout\"] {\n\t\treturn this.state.timeout;\n\t}\n\n\t/**\n\t * 超时时间，单位毫秒\n\t * @default 60000\n\t */\n\tset timeout(value: FastAxiosOption[\"timeout\"]) {\n\t\tthis.setOptions(\"timeout\", value);\n\t}\n\n\t/** 默认头部 */\n\tget headers(): FastAxiosOption[\"headers\"] {\n\t\treturn this.state.headers;\n\t}\n\n\t/** 默认头部 */\n\tset headers(value: FastAxiosOption[\"headers\"]) {\n\t\tthis.setOptions(\"headers\", value);\n\t}\n\n\t/**\n\t * 请求加密解密\n\t * @default true\n\t */\n\tget requestCipher(): FastAxiosOption[\"requestCipher\"] {\n\t\treturn this.state.requestCipher;\n\t}\n\n\t/**\n\t * 请求加密解密\n\t * @default true\n\t */\n\tset requestCipher(value: FastAxiosOption[\"requestCipher\"]) {\n\t\tthis.setOptions(\"requestCipher\", value);\n\t}\n\n\t/** 加载 @description 需要自行处理多次调用的问题 */\n\tget loading(): FastAxiosOption[\"loading\"] {\n\t\treturn this.state.loading;\n\t}\n\n\t/** 加载 @description 需要自行处理多次调用的问题 */\n\tset loading(value: FastAxiosOption[\"loading\"]) {\n\t\tthis.setOptions(\"loading\", value);\n\t}\n\n\t/** 消息提示 */\n\tget message(): FastAxiosOption[\"message\"] {\n\t\treturn this.state.message;\n\t}\n\n\t/** 消息提示 */\n\tset message(value: FastAxiosOption[\"message\"]) {\n\t\tthis.setOptions(\"message\", value);\n\t}\n\n\t/** 消息提示框 */\n\tget messageBox(): FastAxiosOption[\"messageBox\"] {\n\t\treturn this.state.messageBox;\n\t}\n\n\t/** 消息提示框 */\n\tset messageBox(value: FastAxiosOption[\"messageBox\"]) {\n\t\tthis.setOptions(\"messageBox\", value);\n\t}\n\n\t/** 缓存 */\n\tget cache(): FastAxiosOption[\"cache\"] {\n\t\treturn this.state.cache;\n\t}\n\n\t/** 缓存 */\n\tset cache(value: FastAxiosOption[\"cache\"]) {\n\t\tthis.setOptions(\"cache\", value);\n\t}\n\n\t/** 加密解密 */\n\tget crypto(): FastAxiosOption[\"crypto\"] {\n\t\treturn this.state.crypto;\n\t}\n\n\t/** 加密解密 */\n\tset crypto(value: FastAxiosOption[\"crypto\"]) {\n\t\tthis.setOptions(\"crypto\", value);\n\t}\n\n\t/** 拦截器 */\n\tget interceptors(): FastAxiosOption[\"interceptors\"] {\n\t\treturn this.state.interceptors;\n\t}\n\n\t/** 拦截器 */\n\tset interceptors(value: FastAxiosOption[\"interceptors\"]) {\n\t\tthis.setOptions(\"interceptors\", value);\n\t}\n}\n\n/**\n * 初始化 fast-axios\n */\nexport const createFastAxios = (options: Pick<FastAxiosOption, \"baseUrl\" | \"timeout\" | \"headers\" | \"requestCipher\">): FastAxiosOption => {\n\treturn new FastAxios(options);\n};\n\n/**\n * 获取 fast-axios 实例\n */\nexport const useFastAxios = (): FastAxiosOption => {\n\treturn FastAxios.getInstance();\n};\n"],"names":["defaultState","timeout","requestCipher","loading","show","text","close","options","message","success","console","log","warning","warn","info","error","messageBox","confirm","uni","Promise","resolve","reject","showModal","title","content","cancelText","cancelButtonText","confirmText","confirmButtonText","res","fail","Error","window","_FastAxios","constructor","__publicField","this","state","merge","getInstance","instance","setOptions","key","value","baseUrl","headers","cache","crypto","interceptors","FastAxios"],"mappings":"4QAGMA,EAAgC,CACrCC,QAAS,IACTC,eAAe,EACfC,QAAS,CAERC,KAAOC,IAAD,EAENC,MAAQC,IAAD,GAERC,QAAS,CACRC,QAAUD,IAEDE,QAAAC,IAAI,gBAAgBH,IAAS,EAEtCI,QAAUJ,IACDE,QAAAG,KAAK,gBAAgBL,IAAS,EAEvCM,KAAON,IAEEE,QAAAC,IAAI,gBAAgBH,IAAS,EAEtCO,MAAQP,IACCE,QAAAK,MAAM,gBAAgBP,IAAS,GAGzCQ,WAAY,CACXC,QAAUV,GACU,oBAARW,IACH,IAAIC,SAAQ,CAACC,EAASC,KAC5BH,IAAII,UAAU,CACbC,MAAO,OACPC,QAASjB,EAAQC,QACjBiB,WAAYlB,EAAQmB,iBACpBC,YAAapB,EAAQqB,kBACrBnB,QAAUoB,IACLA,EAAIZ,QACCG,IAEDC,GAAA,EAGTS,KAAOD,IAEA,MADCA,GAAAnB,QAAQK,MAAMc,GACf,IAAIE,MAAM,2BAA0B,GAE3C,IAGK,IAAIZ,SAAQ,CAACC,EAASC,KACxB,QAA0B,IAAnBW,OAAOf,QACX,MAAA,IAAIc,MAAM,6BAGbC,OAAOf,QAAQV,EAAQC,SAClBY,IAEDC,GAAA,MAQPY,EAAN,MAAMA,EAKE,WAAAC,CAAY3B,GAFX4B,EAAAC,KAAA,SAGPA,KAAKC,MAAQC,EAAAA,MAAMtC,EAAcO,GAAW,CAAA,EAAE,CAI/C,kBAAcgC,GACT,OAACN,EAAUO,SAKRP,EAAUO,SAJT,IAAIP,CAIK,CAQlB,UAAAQ,CAA4CC,EAAQC,GAC9CP,KAAAC,MAAMK,GAAOJ,EAAAA,MAAMF,KAAKC,MAAMK,GAAMC,EAAK,CAI/C,WAAIC,GACH,OAAOR,KAAKC,MAAMO,OAAA,CAInB,WAAIA,CAAQD,GACNP,KAAAK,WAAW,UAAWE,EAAK,CAOjC,WAAI1C,GACH,OAAOmC,KAAKC,MAAMpC,OAAA,CAOnB,WAAIA,CAAQ0C,GACNP,KAAAK,WAAW,UAAWE,EAAK,CAIjC,WAAIE,GACH,OAAOT,KAAKC,MAAMQ,OAAA,CAInB,WAAIA,CAAQF,GACNP,KAAAK,WAAW,UAAWE,EAAK,CAOjC,iBAAIzC,GACH,OAAOkC,KAAKC,MAAMnC,aAAA,CAOnB,iBAAIA,CAAcyC,GACZP,KAAAK,WAAW,gBAAiBE,EAAK,CAIvC,WAAIxC,GACH,OAAOiC,KAAKC,MAAMlC,OAAA,CAInB,WAAIA,CAAQwC,GACNP,KAAAK,WAAW,UAAWE,EAAK,CAIjC,WAAInC,GACH,OAAO4B,KAAKC,MAAM7B,OAAA,CAInB,WAAIA,CAAQmC,GACNP,KAAAK,WAAW,UAAWE,EAAK,CAIjC,cAAI3B,GACH,OAAOoB,KAAKC,MAAMrB,UAAA,CAInB,cAAIA,CAAW2B,GACTP,KAAAK,WAAW,aAAcE,EAAK,CAIpC,SAAIG,GACH,OAAOV,KAAKC,MAAMS,KAAA,CAInB,SAAIA,CAAMH,GACJP,KAAAK,WAAW,QAASE,EAAK,CAI/B,UAAII,GACH,OAAOX,KAAKC,MAAMU,MAAA,CAInB,UAAIA,CAAOJ,GACLP,KAAAK,WAAW,SAAUE,EAAK,CAIhC,gBAAIK,GACH,OAAOZ,KAAKC,MAAMW,YAAA,CAInB,gBAAIA,CAAaL,GACXP,KAAAK,WAAW,eAAgBE,EAAK,GAvItCR,EAFKF,EAEU,YAFhB,IAAMgB,EAANhB,0BAgJgC1B,GACxB,IAAI0C,EAAU1C,wBAMM,IACpB0C,EAAUV"}