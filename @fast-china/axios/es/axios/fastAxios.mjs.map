{"version":3,"file":"fastAxios.mjs","sources":["../../../../src/axios/fastAxios.ts"],"sourcesContent":["import { merge } from \"lodash-unified\";\nimport type { AxiosOptions, FastAxiosOption } from \"./type\";\n\nconst defaultState: FastAxiosOption = {\n\ttimeout: 60000,\n\trequestCipher: true,\n\tloading: {\n\t\t// eslint-disable-next-line @typescript-eslint/no-empty-function\n\t\tshow: (text: string): void => {},\n\t\t// eslint-disable-next-line @typescript-eslint/no-empty-function\n\t\tclose: (options: AxiosOptions): void => {},\n\t},\n\tmessage: {\n\t\tsuccess: (message) => {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.log(`[Fast.Axios] ${message}`);\n\t\t},\n\t\twarning: (message) => {\n\t\t\tconsole.warn(`[Fast.Axios] ${message}`);\n\t\t},\n\t\tinfo: (message) => {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.log(`[Fast.Axios] ${message}`);\n\t\t},\n\t\terror: (message) => {\n\t\t\tconsole.error(`[Fast.Axios] ${message}`);\n\t\t},\n\t},\n\tmessageBox: {\n\t\tconfirm: (options) => {\n\t\t\tif (typeof uni !== \"undefined\") {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\ttitle: \"温馨提示\",\n\t\t\t\t\t\tcontent: options.message,\n\t\t\t\t\t\tcancelText: options.cancelButtonText,\n\t\t\t\t\t\tconfirmText: options.confirmButtonText,\n\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treject();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfail: (res) => {\n\t\t\t\t\t\t\tres && console.error(res);\n\t\t\t\t\t\t\tthrow new Error(\"'uni.showModal' Api调用异常。\");\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tif (typeof window.confirm === \"undefined\") {\n\t\t\t\t\t\tthrow new Error(\"'window.confirm' Api调用异常。\");\n\t\t\t\t\t}\n\t\t\t\t\t// eslint-disable-next-line no-alert\n\t\t\t\t\tif (window.confirm(options.message)) {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t},\n};\n\nclass FastAxios {\n\t// eslint-disable-next-line no-use-before-define\n\tprivate static instance: FastAxios;\n\tprivate state: FastAxiosOption;\n\n\tpublic constructor(options?: FastAxiosOption) {\n\t\tthis.state = merge(defaultState, options || {});\n\t}\n\n\t/** 获取实例 */\n\tpublic static getInstance(): FastAxios {\n\t\tif (!FastAxios.instance) {\n\t\t\treturn new FastAxios();\n\t\t\t// throw new Error(\"请先调用 'createFastAxios' 初始化 'fast-axios'。\");\n\t\t}\n\n\t\treturn FastAxios.instance;\n\t}\n\n\t/**\n\t * 设置选项\n\t * @param key\n\t * @param value\n\t */\n\tsetOptions<K extends keyof FastAxiosOption>(key: K, value: FastAxiosOption[K]): void {\n\t\tthis.state[key] = merge(this.state[key], value);\n\t}\n\n\t/** 请求域名或者Base路径 */\n\tget baseUrl(): FastAxiosOption[\"baseUrl\"] {\n\t\treturn this.state.baseUrl;\n\t}\n\n\t/** 请求域名或者Base路径 */\n\tset baseUrl(value: FastAxiosOption[\"baseUrl\"]) {\n\t\tthis.setOptions(\"baseUrl\", value);\n\t}\n\n\t/**\n\t * 超时时间，单位毫秒\n\t * @default 60000\n\t */\n\tget timeout(): FastAxiosOption[\"timeout\"] {\n\t\treturn this.state.timeout;\n\t}\n\n\t/**\n\t * 超时时间，单位毫秒\n\t * @default 60000\n\t */\n\tset timeout(value: FastAxiosOption[\"timeout\"]) {\n\t\tthis.setOptions(\"timeout\", value);\n\t}\n\n\t/** 默认头部 */\n\tget headers(): FastAxiosOption[\"headers\"] {\n\t\treturn this.state.headers;\n\t}\n\n\t/** 默认头部 */\n\tset headers(value: FastAxiosOption[\"headers\"]) {\n\t\tthis.setOptions(\"headers\", value);\n\t}\n\n\t/**\n\t * 请求加密解密\n\t * @default true\n\t */\n\tget requestCipher(): FastAxiosOption[\"requestCipher\"] {\n\t\treturn this.state.requestCipher;\n\t}\n\n\t/**\n\t * 请求加密解密\n\t * @default true\n\t */\n\tset requestCipher(value: FastAxiosOption[\"requestCipher\"]) {\n\t\tthis.setOptions(\"requestCipher\", value);\n\t}\n\n\t/** 加载 @description 需要自行处理多次调用的问题 */\n\tget loading(): FastAxiosOption[\"loading\"] {\n\t\treturn this.state.loading;\n\t}\n\n\t/** 加载 @description 需要自行处理多次调用的问题 */\n\tset loading(value: FastAxiosOption[\"loading\"]) {\n\t\tthis.setOptions(\"loading\", value);\n\t}\n\n\t/** 消息提示 */\n\tget message(): FastAxiosOption[\"message\"] {\n\t\treturn this.state.message;\n\t}\n\n\t/** 消息提示 */\n\tset message(value: FastAxiosOption[\"message\"]) {\n\t\tthis.setOptions(\"message\", value);\n\t}\n\n\t/** 消息提示框 */\n\tget messageBox(): FastAxiosOption[\"messageBox\"] {\n\t\treturn this.state.messageBox;\n\t}\n\n\t/** 消息提示框 */\n\tset messageBox(value: FastAxiosOption[\"messageBox\"]) {\n\t\tthis.setOptions(\"messageBox\", value);\n\t}\n\n\t/** 缓存 */\n\tget cache(): FastAxiosOption[\"cache\"] {\n\t\treturn this.state.cache;\n\t}\n\n\t/** 缓存 */\n\tset cache(value: FastAxiosOption[\"cache\"]) {\n\t\tthis.setOptions(\"cache\", value);\n\t}\n\n\t/** 加密解密 */\n\tget crypto(): FastAxiosOption[\"crypto\"] {\n\t\treturn this.state.crypto;\n\t}\n\n\t/** 加密解密 */\n\tset crypto(value: FastAxiosOption[\"crypto\"]) {\n\t\tthis.setOptions(\"crypto\", value);\n\t}\n\n\t/** 拦截器 */\n\tget interceptors(): FastAxiosOption[\"interceptors\"] {\n\t\treturn this.state.interceptors;\n\t}\n\n\t/** 拦截器 */\n\tset interceptors(value: FastAxiosOption[\"interceptors\"]) {\n\t\tthis.setOptions(\"interceptors\", value);\n\t}\n}\n\n/**\n * 初始化 fast-axios\n */\nexport const createFastAxios = (options: Pick<FastAxiosOption, \"baseUrl\" | \"timeout\" | \"headers\" | \"requestCipher\">): FastAxiosOption => {\n\treturn new FastAxios(options);\n};\n\n/**\n * 获取 fast-axios 实例\n */\nexport const useFastAxios = (): FastAxiosOption => {\n\treturn FastAxios.getInstance();\n};\n"],"names":[],"mappings":"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"}